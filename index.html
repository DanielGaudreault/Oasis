<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Oasis - Single File Prototype</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            overflow: hidden;
        }
        
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        canvas {
            display: block;
            background: linear-gradient(to bottom, #001122, #000811);
        }
        
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 20, 40, 0.8);
            padding: 15px;
            border: 2px solid #0ff;
            border-radius: 10px;
            width: 300px;
        }
        
        .zone {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 50, 100, 0.5);
            border: 1px solid #0ff;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .zone:hover {
            background: rgba(0, 100, 200, 0.7);
            transform: translateX(5px);
        }
        
        .zone.active {
            background: rgba(0, 200, 255, 0.3);
            border-color: #ff0;
        }
        
        #playerInfo {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border: 1px solid #0f0;
        }
        
        #chat {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 300px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #f0f;
            padding: 10px;
            overflow-y: auto;
        }
        
        .message {
            margin: 5px 0;
            color: #fff;
        }
        
        .message.system { color: #0ff; }
        .message.player { color: #ff0; }
        
        #avatarCustomizer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border: 3px solid #f0f;
            z-index: 1000;
            display: none;
        }
        
        .colorPicker {
            width: 40px;
            height: 40px;
            display: inline-block;
            margin: 5px;
            cursor: pointer;
            border: 2px solid #fff;
        }
        
        #hud {
            position: absolute;
            top: 20px;
            right: 20px;
            text-align: right;
        }
        
        button {
            background: linear-gradient(45deg, #00f, #0ff);
            border: none;
            padding: 10px 20px;
            margin: 5px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
        }
        
        button:hover {
            background: linear-gradient(45deg, #0ff, #00f);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <div id="ui">
            <h2>üåê OASIS PORTAL</h2>
            <div class="zone active" onclick="enterZone('hub')">üèõÔ∏è CENTRAL HUB</div>
            <div class="zone" onclick="enterZone('racing')">üèéÔ∏è RACING ARENA</div>
            <div class="zone" onclick="enterZone('arcade')">üéÆ RETRO ARCADE</div>
            <div class="zone" onclick="enterZone('social')">üí¨ SOCIAL LOUNGE</div>
            
            <div style="margin-top: 20px;">
                <button onclick="openAvatarCustomizer()">üë§ CUSTOMIZE AVATAR</button>
                <button onclick="toggleChat()">üí¨ TOGGLE CHAT</button>
                <button onclick="addCoin(100)">ü™ô +100 COINS</button>
            </div>
        </div>
        
        <div id="playerInfo">
            <div>üë§ PLAYER: <span id="playerName">USER_001</span></div>
            <div>ü™ô COINS: <span id="coins">1000</span></div>
            <div>üìç ZONE: <span id="currentZone">Central Hub</span></div>
        </div>
        
        <div id="hud">
            <div id="fpsCounter">FPS: 60</div>
            <div id="playerCount">PLAYERS: 1</div>
        </div>
        
        <div id="chat" style="display: none;">
            <div class="message system">Welcome to Mini Oasis!</div>
            <div class="message system">Type /help for commands</div>
            <div class="message player">Player1: Hello world!</div>
            <input type="text" id="chatInput" placeholder="Type message..." style="width: 100%; margin-top: 10px; padding: 5px;">
        </div>
        
        <div id="avatarCustomizer">
            <h2>AVATAR CUSTOMIZER</h2>
            <div>
                <label>Name: <input type="text" id="avatarName" value="USER_001"></label>
            </div>
            <div style="margin: 15px 0;">
                <strong>Body Color:</strong><br>
                <div class="colorPicker" style="background: #3498db;" onclick="setAvatarColor('#3498db')"></div>
                <div class="colorPicker" style="background: #e74c3c;" onclick="setAvatarColor('#e74c3c')"></div>
                <div class="colorPicker" style="background: #2ecc71;" onclick="setAvatarColor('#2ecc71')"></div>
                <div class="colorPicker" style="background: #f1c40f;" onclick="setAvatarColor('#f1c40f')"></div>
                <div class="colorPicker" style="background: #9b59b6;" onclick="setAvatarColor('#9b59b6')"></div>
            </div>
            <div style="margin: 15px 0;">
                <strong>Accessory:</strong><br>
                <button onclick="setAccessory('none')">None</button>
                <button onclick="setAccessory('hat')">üé© Hat</button>
                <button onclick="setAccessory('glasses')">üëì Glasses</button>
                <button onclick="setAccessory('jetpack')">üöÄ Jetpack</button>
            </div>
            <button onclick="saveAvatar()" style="width: 100%;">SAVE & CLOSE</button>
        </div>
    </div>

    <script>
        // ====================
        // GLOBAL VARIABLES
        // ====================
        let canvas, ctx;
        let player = { x: 400, y: 300, color: '#3498db', name: 'USER_001', accessory: 'none' };
        let coins = 1000;
        let currentZone = 'hub';
        let zones = {
            hub: { color: '#2c3e50', objects: [] },
            racing: { color: '#34495e', objects: [] },
            arcade: { color: '#7f8c8d', objects: [] },
            social: { color: '#16a085', objects: [] }
        };
        let lastTime = 0;
        let fps = 60;
        let keys = {};
        let otherPlayers = [
            { x: 300, y: 200, color: '#e74c3c', name: 'Player2', accessory: 'hat' },
            { x: 500, y: 400, color: '#2ecc71', name: 'Player3', accessory: 'glasses' }
        ];
        
        // ====================
        // INITIALIZATION
        // ====================
        function init() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas to full window
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // Setup keyboard controls
            window.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
            window.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);
            
            // Setup chat input
            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Setup zone objects
            initializeZones();
            
            // Start game loop
            requestAnimationFrame(gameLoop);
            
            // Update UI
            updateUI();
            
            console.log('Mini Oasis loaded!');
        }
        
        // ====================
        // ZONE SYSTEM
        // ====================
        function initializeZones() {
            // Hub objects
            zones.hub.objects = [
                { type: 'building', x: 100, y: 100, width: 200, height: 150, color: '#8e44ad' },
                { type: 'portal', x: 600, y: 500, width: 50, height: 100, color: '#f39c12', target: 'racing' },
                { type: 'coin', x: 300, y: 300, collected: false }
            ];
            
            // Racing zone objects
            zones.racing.objects = [
                { type: 'track', x: 200, y: 100, width: 400, height: 400, color: '#95a5a6' },
                { type: 'car', x: 250, y: 150, width: 30, height: 60, color: '#e74c3c' },
                { type: 'finish', x: 200, y: 450, width: 400, height: 10, color: '#f1c40f' }
            ];
            
            // Arcade zone objects
            zones.arcade.objects = [
                { type: 'machine', x: 150, y: 200, width: 100, height: 150, color: '#9b59b6', game: 'space' },
                { type: 'machine', x: 350, y: 200, width: 100, height: 150, color: '#1abc9c', game: 'puzzle' },
                { type: 'machine', x: 550, y: 200, width: 100, height: 150, color: '#d35400', game: 'racing' }
            ];
            
            // Social zone objects
            zones.social.objects = [
                { type: 'sofa', x: 200, y: 300, width: 200, height: 50, color: '#c0392b' },
                { type: 'table', x: 400, y: 300, width: 100, height: 100, color: '#7d3c98' },
                { type: 'jukebox', x: 600, y: 300, width: 80, height: 120, color: '#2980b9' }
            ];
        }
        
        function enterZone(zoneId) {
            currentZone = zoneId;
            
            // Update UI
            document.querySelectorAll('.zone').forEach(z => z.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('currentZone').textContent = zoneId.charAt(0).toUpperCase() + zoneId.slice(1);
            
            // Position player in zone center
            player.x = canvas.width / 2;
            player.y = canvas.height / 2;
            
            // Add system message
            addChatMessage(`System: Entered ${zoneId} zone`, 'system');
        }
        
        // ====================
        // GAME LOOP
        // ====================
        function gameLoop(timestamp) {
            // Calculate delta time
            const deltaTime = timestamp - lastTime || 0;
            lastTime = timestamp;
            
            // Calculate FPS
            fps = Math.round(1000 / deltaTime);
            
            // Clear canvas
            ctx.fillStyle = zones[currentZone].color;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw zone-specific objects
            drawZoneObjects();
            
            // Handle player input
            handleInput(deltaTime);
            
            // Draw other players
            drawOtherPlayers();
            
            // Draw player
            drawPlayer();
            
            // Draw HUD
            drawHUD();
            
            // Check collisions
            checkCollisions();
            
            // Update FPS counter
            document.getElementById('fpsCounter').textContent = `FPS: ${fps}`;
            
            // Continue loop
            requestAnimationFrame(gameLoop);
        }
        
        // ====================
        // DRAWING FUNCTIONS
        // ====================
        function drawZoneObjects() {
            zones[currentZone].objects.forEach(obj => {
                ctx.fillStyle = obj.color;
                
                switch(obj.type) {
                    case 'building':
                        ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                        // Add windows
                        ctx.fillStyle = '#f1c40f';
                        for(let i = 0; i < 3; i++) {
                            for(let j = 0; j < 2; j++) {
                                ctx.fillRect(obj.x + 20 + i*50, obj.y + 20 + j*40, 20, 20);
                            }
                        }
                        break;
                        
                    case 'portal':
                        ctx.fillStyle = obj.color;
                        ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                        ctx.fillStyle = '#000';
                        ctx.font = '20px Arial';
                        ctx.fillText('‚Üí', obj.x + 15, obj.y + 60);
                        break;
                        
                    case 'coin':
                        if(!obj.collected) {
                            ctx.fillStyle = '#f1c40f';
                            ctx.beginPath();
                            ctx.arc(obj.x, obj.y, 15, 0, Math.PI * 2);
                            ctx.fill();
                            ctx.fillStyle = '#000';
                            ctx.font = 'bold 16px Arial';
                            ctx.fillText('$', obj.x - 5, obj.y + 5);
                        }
                        break;
                        
                    case 'track':
                        ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                        ctx.strokeStyle = '#fff';
                        ctx.lineWidth = 5;
                        ctx.strokeRect(obj.x, obj.y, obj.width, obj.height);
                        break;
                        
                    case 'machine':
                        ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                        ctx.fillStyle = '#fff';
                        ctx.font = '12px Arial';
                        ctx.fillText(obj.game.toUpperCase(), obj.x + 10, obj.y + 80);
                        break;
                        
                    default:
                        ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
                }
            });
        }
        
        function drawPlayer() {
            // Draw body
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x - 15, player.y - 25, 30, 50);
            
            // Draw head
            ctx.fillStyle = '#f1c2a9';
            ctx.beginPath();
            ctx.arc(player.x, player.y - 40, 15, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw accessory
            switch(player.accessory) {
                case 'hat':
                    ctx.fillStyle = '#8b4513';
                    ctx.fillRect(player.x - 20, player.y - 60, 40, 15);
                    ctx.fillRect(player.x - 15, player.y - 75, 30, 15);
                    break;
                case 'glasses':
                    ctx.fillStyle = '#000';
                    ctx.fillRect(player.x - 20, player.y - 42, 15, 5);
                    ctx.fillRect(player.x + 5, player.y - 42, 15, 5);
                    ctx.fillRect(player.x - 5, player.y - 42, 10, 2);
                    break;
                case 'jetpack':
                    ctx.fillStyle = '#7f8c8d';
                    ctx.fillRect(player.x + 20, player.y - 10, 15, 30);
                    ctx.fillStyle = '#e74c3c';
                    ctx.fillRect(player.x + 22, player.y + 20, 11, 20);
                    break;
            }
            
            // Draw player name
            ctx.fillStyle = '#fff';
            ctx.font = '12px Arial';
            ctx.fillText(player.name, player.x - 25, player.y - 90);
        }
        
        function drawOtherPlayers() {
            otherPlayers.forEach(p => {
                // Body
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x - 15, p.y - 25, 30, 50);
                
                // Head
                ctx.fillStyle = '#f1c2a9';
                ctx.beginPath();
                ctx.arc(p.x, p.y - 40, 15, 0, Math.PI * 2);
                ctx.fill();
                
                // Name
                ctx.fillStyle = '#fff';
                ctx.font = '12px Arial';
                ctx.fillText(p.name, p.x - 25, p.y - 90);
                
                // Simulate movement
                p.x += Math.sin(Date.now() / 1000) * 0.5;
                p.y += Math.cos(Date.now() / 1000) * 0.3;
            });
        }
        
        function drawHUD() {
            // Draw mini-map
            ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
            ctx.fillRect(10, 10, 150, 150);
            ctx.fillStyle = '#fff';
            ctx.font = '10px Arial';
            ctx.fillText('MAP', 70, 20);
            
            // Draw zone indicator
            ctx.fillStyle = zones[currentZone].color;
            ctx.beginPath();
            ctx.arc(85, 85, 40, 0, Math.PI * 2);
            ctx.fill();
            
            // Draw player position on map
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(85, 85, 5, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // ====================
        // INPUT HANDLING
        // ====================
        function handleInput(deltaTime) {
            const speed = 5;
            
            if(keys['w'] || keys['arrowup']) player.y -= speed;
            if(keys['s'] || keys['arrowdown']) player.y += speed;
            if(keys['a'] || keys['arrowleft']) player.x -= speed;
            if(keys['d'] || keys['arrowright']) player.x += speed;
            
            // Keep player in bounds
            player.x = Math.max(20, Math.min(canvas.width - 20, player.x));
            player.y = Math.max(45, Math.min(canvas.height - 25, player.y));
            
            // Spacebar to jump (visual effect only)
            if(keys[' ']) {
                ctx.fillStyle = '#0ff';
                ctx.beginPath();
                ctx.arc(player.x, player.y + 30, 10, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // ====================
        // GAME LOGIC
        // ====================
        function checkCollisions() {
            zones[currentZone].objects.forEach(obj => {
                if(obj.type === 'coin' && !obj.collected) {
                    const dist = Math.sqrt(Math.pow(player.x - obj.x, 2) + Math.pow(player.y - obj.y, 2));
                    if(dist < 30) {
                        obj.collected = true;
                        addCoin(50);
                        addChatMessage(`System: Found 50 coins!`, 'system');
                    }
                }
                
                if(obj.type === 'portal') {
                    const inPortal = player.x > obj.x && player.x < obj.x + obj.width &&
                                    player.y > obj.y && player.y < obj.y + obj.height;
                    if(inPortal) {
                        enterZone(obj.target);
                    }
                }
            });
        }
        
        // ====================
        // UI FUNCTIONS
        // ====================
        function openAvatarCustomizer() {
            document.getElementById('avatarCustomizer').style.display = 'block';
        }
        
        function setAvatarColor(color) {
            player.color = color;
        }
        
        function setAccessory(type) {
            player.accessory = type;
        }
        
        function saveAvatar() {
            player.name = document.getElementById('avatarName').value;
            document.getElementById('avatarCustomizer').style.display = 'none';
            document.getElementById('playerName').textContent = player.name;
            addChatMessage(`System: Avatar updated!`, 'system');
        }
        
        function toggleChat() {
            const chat = document.getElementById('chat');
            chat.style.display = chat.style.display === 'none' ? 'block' : 'none';
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            if(input.value.trim()) {
                addChatMessage(`${player.name}: ${input.value}`, 'player');
                input.value = '';
                
                // Simulate responses
                setTimeout(() => {
                    const responses = [
                        "Cool!",
                        "Welcome to the Oasis!",
                        "Anyone want to race?",
                        "Check out my new avatar!",
                        "This place is awesome!"
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addChatMessage(`Player${Math.floor(Math.random()*5)+2}: ${randomResponse}`, 'player');
                }, 1000);
            }
        }
        
        function addChatMessage(text, type) {
            const chat = document.getElementById('chat');
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            chat.appendChild(message);
            chat.scrollTop = chat.scrollHeight;
        }
        
        function addCoin(amount) {
            coins += amount;
            updateUI();
        }
        
        function updateUI() {
            document.getElementById('coins').textContent = coins;
            document.getElementById('playerCount').textContent = `PLAYERS: ${otherPlayers.length + 1}`;
        }
        
        // ====================
        // START THE GAME
        // ====================
        window.onload = init;
        window.onresize = function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        };
    </script>
</body>
</html>
